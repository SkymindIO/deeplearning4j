# Dynamic Indexing

## Status
**Discussion**

Proposed by: Adam Gibson (31 Jan 2023)


## Context

Users should be able to define their own custom operations including custom gradients.
Right now in order to define a UDF it would not be properly integrated
unless you handle the following:
1. Registering the op with the
2. Special code paths in the op executioners that support calling user defined code
3. Special code paths for serialization to handle properly loading a samediff graph with
the correct op
4. A direct function call in samediff itself tha that handles properly registering the op as part of the graph


## Proposal


Support custom UDFS

1. An op type so the FlatBuffersMapper (used for saving graphs) knows how to save/load UDFs
2. A base class for having clear overrides
3. An exec method where the user passes in relevant inputs and will be what gets used by the op executioner (rather than going down to c++)
4. A hook in samediff with something like: sd.udf(..)
5. An annotation or subclass scanner like we discussed for registration in relevant areas like the the ImportClassMappings


## Consequences

### Advantages

* Allows users to define their own ops to make optimizations or to introduce custom ops
for use within samediff
* Augments model import by combining annotation scanning from model import with 
annotation registration of udfs with similar annotations

### Disadvantages
* A bit lower level which means users can misuse the api or encounter bugs they might not 
otherwise with ops maintained in the core framework